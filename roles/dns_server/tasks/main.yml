---

##
# Almost all of the config for this role is handled by the dependencies listed in 
# `../meta/main.yml`.
##

- name: Firewall - Allow DNS Traffic
  ufw:
    rule: allow
    name: Bind9
  become: true

- name: Ensure Stub OpenDKIM Record Exists
  copy:
    content: ''
    dest: "/etc/bind/dkim-{{ domain }}.record"
    force: false
    owner: root
    group: root
    mode: u=rw,g=r,o=r
  become: true

- include: test.yml
  tags: test
